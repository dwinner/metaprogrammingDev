using System.Linq;
using CaplGrammar.Application;
using CaplGrammar.Application.Contract;
using CaplGrammar.Application.Impl.GrammarValidation;
using CaplGrammar.Application.Poco;
using NUnit.Framework;

namespace Capl.UnitTests
{
    [TestFixture]
    public class CaplSyntaxCheckTests
    {
        private static readonly object[] CanSources =
        {
            new object[] { @"src\\hex_handling.can" },
            new object[] { @"src\\timer_issues.can" },
            new object[] { @"src\\transmission.can" },
            new object[] { @"src\\multiplexed_message.can" },
            new object[] { @"src\\misc_operators.can" },
            new object[] { @"src\\NMHKombiReader.can" },
            new object[] { @"src\\conditional_transmission.can" },
            new object[] { @"src\\qualified_id.can" },
            new object[] { @"src\\error_frames.can" },
            new object[] { @"src\\var_declarations.can" },
            new object[] { @"src\\TCPClt.can" },
            new object[] { @"src\\TCPSrv.can" },
            new object[] { @"src\\enum_ex.can" },
            new object[] { @"src\\this_keyword.can" },
            new object[] { @"src\\for_stmt.can" },
            new object[] { @"src\\includes.can" },
            new object[] { @"src\\relational_operators.can" },
            new object[] { @"src\\phys_raw_ex.can" },
            new object[] { @"src\\clone.can" },
            new object[] { @"src\\boolean_operators.can" },
            new object[] { @"src\\periodic_transmission.can" },
            new object[] { @"src\\Variablenmapping.can" },
            new object[] { @"src\\arithmetic_operators.can" },
            new object[] { @"src\\GW_DV.can" },
            new object[] { @"src\\sysvar_ex.can" },
            new object[] { @"src\\bitwise_operators.can" },
            new object[] { @"src\\timers.can" },
            new object[] { @"src\\while_stmt.can" },
            new object[] { @"src\\if_op.can" },
            new object[] { @"src\\struct_ex.can" },
            new object[] { @"src\\top_level_repl.can" },
            new object[] { @"src\\unconditional.can" },
            new object[] { @"src\\const_keyword.can" },
            new object[] { @"src\\diagResponse.can" },
            new object[] { @"src\\assignment_operators.can" },
            new object[] { @"src\\Wegstrecke.can" },
            new object[] { @"src\\export_ex.can" },
            new object[] { @"src\\switch_stmt.can" },
            new object[] { @"src\\input_source.can" },
            new object[] { @"src\\char_issues.can" },
            new object[] { @"src\\misc_event_handlers.can" },
            new object[] { @"src\\Zeiten_Ethernet.can" },
            new object[] { @"src\\diagRequest.can" },
            new object[] { @"src\\BCM_LTM_PopUp_Inhalt.can" },
            new object[] { @"src\\Zeiten_CAN.can" },
            new object[] { @"src\\logging.can" },
            new object[] { @"src\\events.can" },
            new object[] { @"src\\example.can" },
            new object[] { @"src\\func_declarations.can" },
            new object[] { @"src\\RBS_Menu.can" },
            new object[] { @"src\\Utf8Output_ch2.can" },
            new object[] { @"src\\Wegimpulse.can" },
            new object[] { @"src\\Testboard_Relais.can" },
            new object[] { @"src\\messages.can" },
            new object[] { @"src\\messages_issues.can" },
            new object[] { @"src\\common.can" },
            new object[] { @"src\\HUD_VDO.can" },
            new object[] { @"src\\HU_active.can" },
            new object[] { @"src\\Timeouts_Ethernet_Kombi.can" },
            new object[] { @"src\\SW_Gateway_Videostreaming_PortChange.can" },
            new object[] { @"src\\CAB_Ethernet.can" },
            new object[] { @"src\\NaviSD_Gateway.can" },
            new object[] { @"src\\dateandtime.can" },
            new object[] { @"src\\functions.can" },
            new object[] { @"src\\Timeouts_Ethernet_MIB3.can" },
            new object[] { @"src\\SoftwareDownload.can" },
            new object[] { @"src\\MQB_Klemmensignal.can" },
            new object[] { @"src\\Geschwindigkeit.can" },
            new object[] { @"src\\Blinker.can" },
            // new object[] { @"src\\Message_5_Cyc_and_Spont_without_Delay.can" },
            new object[] { @"src\\UDP_Node.can" },
            new object[] { @"src\\SocketAdapter.can" },
            new object[] { @"src\\CycleMeasure.can" },
            new object[] { @"src\\RTPServer.can" },
            new object[] { @"src\\Filter_HB.can" },
            new object[] { @"src\\io.can" },
            // new object[] { @"src\\Message_5_Cyc_and_Spont_with_Delay.can" },
            new object[] { @"src\\Message_2_cyclicIfActiveX.can" },
            new object[] { @"src\\BZ_CRC.can" },
            new object[] { @"src\\ComponentProtection.can" },
            new object[] { @"src\\Test_KBI_PT.can" },
            new object[] { @"src\\MOSTReliabilityTest.can" },
            new object[] { @"src\\CAB.can" },
            new object[] { @"src\\testcase_ex.can" },
            new object[] { @"src\\TCO_IC_VDO.can" },
            new object[] { @"src\\EthStress.can" },
            new object[] { @"src\\HU.can" },
            new object[] { @"src\\RTPClt.can" },
            new object[] { @"src\\TestcaseCanWakeup.can" },
            new object[] { @"src\\GC_Test_EL.can" },
            new object[] { @"src\\Kombi_HUD.can" },
            new object[] { @"src\\KsMaster.can" },
            new object[] { @"src\\NavigationInfo.can" },
            new object[] { @"src\\Vector__XXX.can" },
            new object[] { @"src\\GC_Test_HL.can" },
            new object[] { @"src\\PowerMaster.can" },
            new object[] { @"src\\Ethernet.can" },
            new object[] { @"src\\NetworkMaster.can" },
            new object[] { @"src\\PowerSupply.can" },
            new object[] { @"src\\ATM.can" },
            new object[] { @"src\\ImmoTest_EMV.can" },
            new object[] { @"src\\keypanel.can" },
            new object[] { @"src\\EthGeneral_ETH_Cluster_MEB.can" },
            new object[] { @"src\\Verbrauch_Rekuperation.can" },
            new object[] { @"src\\ImmoTest.can" },
            new object[] { @"src\\CAMF.can" },
            new object[] { @"src\\RTPServ.can" },
            new object[] { @"src\\NDP_AR_Creator.can" },
            new object[] { @"src\\BAP_Tester.can" },
            new object[] { @"src\\TEL-Listhandling_Audi.can" },
            new object[] { @"src\\TEL-Listhandling_VW.can" },
            new object[] { @"src\\ImmoTest_Fpke.can" },
            new object[] { @"src\\MFL.can" },
            new object[] { @"src\\BAPServer.can" },
            new object[] { @"src\\RBS_NMHigh.can" },
            new object[] { @"src\\BAP_Main_Audi.can" },
            new object[] { @"src\\BAP_Main.can" },
            new object[] { @"src\\MostScan.can" },
            new object[] { @"src\\Generators.can" },
            new object[] { @"src\\VDO_pDemo.can" },
            new object[] { @"src\\Acustics.can" },
            new object[] { @"src\\ECL_STI.can" },
            new object[] { @"src\\Video.can" },
            new object[] { @"src\\TSA-Input.can" },
            new object[] { @"src\\DoIP_Tester2.can" },
            new object[] { @"src\\SMG.can" },
            new object[] { @"src\\Variablenmapping_Eth.can" },
            new object[] { @"src\\RBS_Startup.can" },
            new object[] { @"src\\HID_DisplayControl.can" },
            new object[] { @"src\\ksslave.can" },
            new object[] { @"src\\canOpenMasterLinde.can" },
            new object[] { @"src\\TPAD_VDO.can" },
            new object[] { @"src\\HID_Warping.can" },
            new object[] { @"src\\ABKUHTS-Knoten.can" },
            new object[] { @"src\\RBS_IntegrationTest.can" },
            new object[] { @"src\\PCI_Card.can" },
            new object[] { @"src\\Kombi_CAN.can" },
            new object[] { @"src\\RBS_Peckbox.can" },
            new object[] { @"src\\Audio-ListHandling_Audi.can" },
            new object[] { @"src\\NDP_Cluster.can" },
            new object[] { @"src\\TCO.can" },
            new object[] { @"src\\DISP_RR.can" },
            new object[] { @"src\\DISP_RL.can" },
            new object[] { @"src\\FoD_MasterSim_CAN_CANFD_Extended.can" },
            new object[] { @"src\\HUD.can" },
            new object[] { @"src\\SmartLight_01.can" },
            new object[] { @"src\\TA_02.can" },
            new object[] { @"src\\KombiEth2.can" },
            new object[] { @"src\\KombiTestNode.can" },
            new object[] { @"src\\TSA-Output.can" },
            new object[] { @"src\\Kombi.can" },
            new object[] { @"src\\Fahrerdisplay_Kombi.can" },
            new object[] { @"src\\RBTM_FR.can" },
            new object[] { @"src\\RBTM_FL.can" },
            new object[] { @"src\\HUD_Diag.can" },
            new object[] { @"src\\NGSM.can" },
            new object[] { @"src\\ZR_MIB_TOP_ab_Gen3.can" },
            new object[] { @"src\\RBS_Control.can" },
            new object[] { @"src\\ICAS3_Gateway.can" },
            new object[] { @"src\\TesterDienste.can" },
            new object[] { @"src\\EthTestability.can" },
            new object[] { @"src\\MainUnit01.can" },
            new object[] { @"src\\MainUnit06.can" },
            new object[] { @"src\\MainUnit08.can" },
            new object[] { @"src\\MainUnit07.can" },
            new object[] { @"src\\MainUnit09.can" },
            new object[] { @"src\\MainUnit10.can" },
            new object[] { @"src\\MainUnit11.can" },
            new object[] { @"src\\MainUnit12.can" },
            new object[] { @"src\\MainUnit03.can" },
            new object[] { @"src\\MainUnit04.can" },
            new object[] { @"src\\MainUnit05.can" },
            new object[] { @"src\\MainUnit02.can" },
            new object[] { @"src\\Utf8Output.can" },
            new object[] { @"src\\SVS.can" },
            new object[] { @"src\\NM_StateMachine_old.can" },
            new object[] { @"src\\PictureServer.can" },
            new object[] { @"src\\CTRL_C.can" },
            new object[] { @"src\\HeadUnit.can" },
            new object[] { @"src\\NM_StateMachine.can" },
            new object[] { @"src\\RBS_TransmitLog.can" },
            new object[] { @"src\\RBS_Display.can" },
            new object[] { @"src\\Gateway_DoIP.can" },
            new object[] { @"src\\TPM.can" },
            new object[] { @"src\\Timeouts.can" },
            new object[] { @"src\\VDO_pKey.can" },
            new object[] { @"src\\VDO_pSyrto.can" },
            new object[] { @"src\\NV.can" },
            new object[] { @"src\\ASG_SDS_SD_BAPv1.7_v1.00.can" },
            new object[] { @"src\\NM_StateMachine_old3.can" },
            new object[] { @"src\\RBS_Sweep.can" },
            new object[] { @"src\\ICAS1_Gateway.can" },
            new object[] { @"src\\FSG58.can" },
            new object[] { @"src\\RBS_IncDec2.can" },
            new object[] { @"src\\Powertest.can" },
            new object[] { @"src\\ORC.can" },
            new object[] { @"src\\DRVU.can" },
            new object[] { @"src\\DoIP_Testnode1.can" },
            new object[] { @"src\\MCI.can" },
            new object[] { @"src\\RBS_ControlG.can" },
            new object[] { @"src\\IC_VDO CRC_Retransmit.can" },
            new object[] { @"src\\FSG42.can" },
            new object[] { @"src\\RBS_Decode.can" },
            new object[] { @"src\\FSG52.can" },
            new object[] { @"src\\PERF.can" },
            new object[] { @"src\\FSG12.can" },
            new object[] { @"src\\ASG18_1.can" },
            new object[] { @"src\\FSG_SDS_SD_BAPv1.7_v1.00.can" },
            new object[] { @"src\\HIL_Display.can" },
            new object[] { @"src\\IC_VDO.can" },
            new object[] { @"src\\ADC.can" },
            new object[] { @"src\\Klima.can" },
            new object[] { @"src\\FSG29.can" },
            new object[] { @"src\\ASG74_1.can" },
            new object[] { @"src\\INTEGR_noBAP.can" },
            new object[] { @"src\\ASG70_1.can" },
            new object[] { @"src\\ASG78_1.can" },
            new object[] { @"src\\ASG17_1.can" },
            new object[] { @"src\\ASG19_1.can" },
            new object[] { @"src\\RBS_DecodeGateway.can" },
            new object[] { @"src\\ASG19_4.can" },
            new object[] { @"src\\ASG70_Simu.can" },
            new object[] { @"src\\ASG70.can" },
            new object[] { @"src\\IC.can" },
            new object[] { @"src\\FSG39.can" },
            new object[] { @"src\\FSG27.can" },
            new object[] { @"src\\ICAS3_Sys_IVI_01.can" },
            new object[] { @"src\\ASG33_1.can" },
            new object[] { @"src\\FSG26.can" },
            new object[] { @"src\\FSG70_Simu.can" },
            new object[] { @"src\\FSG70.can" },
            new object[] { @"src\\RBS_Send.can" },
            new object[] { @"src\\INTEGR.can" },
            new object[] { @"src\\RBS_IncDec1.can" },
            new object[] { @"src\\FSG60.can" },
            new object[] { @"src\\EIS_VDO.can" },
            new object[] { @"src\\FSG25.can" },
            new object[] { @"src\\FSG7.can" },
            new object[] { @"src\\FSG35.can" },
            new object[] { @"src\\FSG33.can" },
            new object[] { @"src\\ASG_DisplayConfig_BAPv1.8_v1.00.can" },
            new object[] { @"src\\ASG_NaviSD_BAPv1.5_v1.21.can" },
            new object[] { @"src\\BAP_SaveINI_Audi.can" },
            new object[] { @"src\\ASG4_0.can" },
            new object[] { @"src\\BAP_SaveINI.can" },
            new object[] { @"src\\ASG10_1.can" },
            new object[] { @"src\\ASG15_1.can" },
            new object[] { @"src\\ASG15_2.can" },
            new object[] { @"src\\FSG4.can" },
            new object[] { @"src\\FSG80.can" },
            new object[] { @"src\\FSG85.can" },
            new object[] { @"src\\FSG10.can" },
            new object[] { @"src\\RBS_SendGateway.can" },
            new object[] { @"src\\Kombi_SimulatedPeerNodes.can" },
            new object[] { @"src\\RBS_Init.can" },
            new object[] { @"src\\FSG_Telephone_BAPv1.8_v3.0.can" },
            new object[] { @"src\\FSG82.can" },
            new object[] { @"src\\ServiceControl_AR_Creator.can" },
            new object[] { @"src\\FSG_AudioSD_Ethernet.can" },
            new object[] { @"src\\FSG_AudioSD.can" },
            new object[] { @"src\\diagnostic.can" },
            new object[] { @"src\\FSG41.can" },
            new object[] { @"src\\TGW.can" },
            new object[] { @"src\\ASG49.can" },
            new object[] { @"src\\ASG50_1.can" },
            new object[] { @"src\\FSG_NaviSD_BAPv1.5_v1.21.can" },
            new object[] { @"src\\FSG_NaviSD_BAPv1.5_v1.21_DV.can" },
            new object[] { @"src\\BAPControl_Main.can" },
            new object[] { @"src\\ASG69_1.can" },
            new object[] { @"src\\ASG69.can" },
            new object[] { @"src\\FSG49.can" },
            new object[] { @"src\\FSG_AudioSD_v1.20_MIB_Ethernet.can" },
            new object[] { @"src\\FSG50.can" },
            new object[] { @"src\\FSG40.can" },
            new object[] { @"src\\FSG_Telephone_BAPv1.5_v0.48.can" },
            new object[] { @"src\\ASG_AudioSD.can" },
            new object[] { @"src\\ServiceControl_Cluster.can" },
            new object[] { @"src\\ASG_Telephone_BAPv1.5_v0.96.can" },
            new object[] { @"src\\ICAS3_Sys_IVI_01_SimulatedPeerNodes.can" },
            new object[] { @"src\\EIS_Penio.can" },
            new object[] { @"src\\EIS_2.can" },
            new object[] { @"src\\FSG_AudioSD_v1.20_MIB.can" },
            new object[] { @"src\\GenericVariableBackup.can" },
            new object[] { @"src\\EIS_3.can" },
            new object[] { @"src\\BAPVariableBackup.can" },
            new object[] { @"src\\ASG_AudioSD_v1.20_MIB_Ethernet.can" },
            new object[] { @"src\\ASG_AudioSD_v1.20_MIB.can" },
            new object[] { @"src\\EIS.can" },
            new object[] { @"src\\DLM.can" },
            new object[] { @"src\\ARC.can" },
            new object[] { @"src\\TGW_HMI_VDO.can" },
            new object[] { @"src\\TGW_HU_VDO.can" },
            new object[] { @"src\\TimeToArchitectureStyleSwitch.can" },
            new object[] { @"src\\TimeToSingleLineMessage.can" },
            new object[] { @"src\\AdcEventRouting_213.can" },
            new object[] { @"src\\TimeToWarning.can" },
            new object[] { @"src\\TimeToWSound.can" },
            new object[] { @"src\\APIUpdateBurst.can" },
            new object[] { @"src\\TripMenuFastScrolling.can" },
            new object[] { @"src\\GPU_RAM.can" },
            new object[] { @"src\\DependencyChangeRuntime.can" },
            new object[] { @"src\\HudStressByConsumption.can" },
            new object[] { @"src\\CANopenMasterStill.can" },
            new object[] { @"src\\FehlerbitmusterInterpreter.can" },
            new object[] { @"src\\GoToBolo.can" },
            new object[] { @"src\\KeyboardLinde.can" },
            new object[] { @"src\\KeyboardStill.can" },
            new object[] { @"src\\measureStartUpTime.can" },
            new object[] { @"src\\MemoryAccess.can" },
            new object[] { @"src\\nach_Spekl_ReadErrorData.can" },
            new object[] { @"src\\ReadErrorData.can" },
            new object[] { @"src\\ReadErrorDataStill.can" },
            new object[] { @"src\\secacc.can" },
            new object[] { @"src\\slavekillhelp.can" },
            new object[] { @"src\\SlaveNVM-kill.can" },
            new object[] { @"src\\SleepTest.can" },
            new object[] { @"src\\Still_FehlermusterInterpreter.can" },
            new object[] { @"src\\Still_measureStartUpTime.can" },
            new object[] { @"src\\Test_IsaCanReceive.can" },
            new object[] { @"src\\Test_IsaCanTransmit.can" },
            new object[] { @"src\\U_T_SdoReadTest.can" }
        };

        [TestCaseSource(nameof(CanSources))]
        public void TestCanSyntax(string canFile)
        {
            ICaplValidation sntxValidation = new CaplSyntaxValidationImpl();
            var caplIssues = sntxValidation.GetIssues(canFile, AntlrInput.FromFile);
            var errors = caplIssues as CaplIssue[] ?? caplIssues.ToArray();
            Assert.IsEmpty(errors, "There are '{0}' syntax errors in file '{1}'",
                errors.Length,
                canFile);
        }
    }
}